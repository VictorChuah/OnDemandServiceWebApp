@model System.Collections.Generic.List<fyptest.Models.JobViewModel>
@{
  ViewBag.Title = "Index";
  Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Index</h2>
<br />
<br />
<br />
<div id="app">
  <h3>@ViewBag.Message</h3>
  {{ vueMessage }}
  <br />
  <transition>
    <router-view></router-view>
  </transition>
  {{ secMessage }}
  <app v-bind:time="new Date()"></app>
</div>
<div style="height: 113px;"></div>

<div class="unit-5 overlay" style="background-image: url(@Url.Content("~/Content/main/")images/hero_1.jpg);">
  <div class="container text-center">
    <h2 class="mb-0">Blog</h2>
    <p class="mb-0 unit-6"><a href="index.html">Home</a> <span class="sep">></span> <span>Blog</span></p>
  </div>
</div>
<div class="site-section bg-light">
  <div class="container">
    <div class="row">
      @if (Model != null)
      {
        foreach (var item in Model)
        {
          <div class="col-md-6 mb-5 mb-lg-4 col-lg-3" data-aos="fade">
            <div class="position-relative unit-8">
              <a href="#" class="mb-3 d-block img-a" style="height: 255px; line-height: 255px; background: white;"><img src="@item.Image" alt="" class="img-fluid rounded"></a>
              <span class="d-block text-gray-500 text-normal small mb-3">By <a href="#">@item.Seeker</a> <span class="mx-2">&bullet;</span> @item.Date</span>
              <h2 class="h5 font-weihgt-normal line-height-sm mb-3"><a href="#" class="text-black">@item.Title</a></h2>
              <p>@item.Description</p>
              <p><a href="/Service/JobView/@item.JobID">View more...</a></p>
              <span>
                @if (Session["Role"] != null)
                {
                  if (Session["Role"].ToString() == "Provider")
                  {
                    <button class="btn btn-success new" onclick='applyJob(@Html.Raw(Json.Encode(item)),this)'><i class="fa fa-plus"></i> Apply now</button>
                  }
                }
              </span>
            </div>

          </div>
        }
      }
    </div>
  </div>
</div>


@section foot {
  <script src="~/Scripts/bundle/home.js"></script>
  <script type="text/javascript">

      function applyJob(model, el) {
        var data = {};
        data.SId = model.JobID;
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            data:  JSON.stringify(data),
            url: "/Service/ApplyJob",
            success: function (success) {
                alert(success.Message);
            },
            error: function (result) {
                alert(result.Error);
            }
        })

      }
  </script>
}
